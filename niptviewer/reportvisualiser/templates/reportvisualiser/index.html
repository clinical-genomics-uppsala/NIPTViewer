{% extends "base.html" %}
{% load static tz %}

{% block title %}
NIPTViewer: Flowcells run
{% endblock %}

{% block head_css %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/nvd3/1.8.6/nv.d3.css">
{% endblock %}
{% block head_js %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.2/d3.min.js" charset="utf-8"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/nvd3/1.8.6/nv.d3.min.js"></script>
<script src="{% static "run_visualiser/js/scatter_chart.js" %}"></script>
<script src="{% static "run_visualiser/js/line_chart.js" %}"></script>
{% endblock %}

{% block content %}
<div class="section">
  <div class="row white">
    <div id="scatter_chart_ff" style="width:100%;height:400px;">
      <div class=center-align>
        <h4> Fetal fraction</h4>
      </div>
        <svg style="width:100%;height:400px;"></svg>
    </div>
    <script>
      scatterChartTime({{ data_ff_time|safe }},'#scatter_chart_ff svg', 'Date', 'Fetal fraction', '0.02f', '0.02%',null,null,0,0.2);
    </script>
    <br /><br />
    <div id="median_coverage">
      <div class=center-align>
        <h4> Median Coverage</h4>
      </div>
      <svg style="width:100%;height:400px"></svg>
    </div>
    <script>lineChart({{ median_coverage|safe }},'#median_coverage svg', 'Date', 'Coverage');</script>
  </div>
</div>
<div class="section">
    <div class="row white">
    <div class=center-align>
      <h4> Runs</h4>
    </div>
    <table>
      <thead>
      <tr>
        <th>Barcode</th>
        <th>Run date</th>
        <th>Uploaded</th>
        <th>Illumina Software version</th>
      </tr>
      </thead>
      <tbody>
    {% for flowcell in flowcell_data %}
    <tr>
    <td><a  class="cyan-text text-darken-4"href="{% url 'viewer:report' barcode=flowcell.flowcell_id.flowcell_barcode %}">{{ flowcell.flowcell_id.flowcell_barcode}}</a></td>
    <td>{% timezone "Europe/Paris" %}{{ flowcell.flowcell_id.run_date|date:"Y-m-d"}}{% endtimezone %}</td>
    <td>{% timezone "Europe/Paris" %}{{ flowcell.flowcell_id.created|date:"Y-m-d"}}{% endtimezone %}</td>
    <td>{{ flowcell.software_version }}</td>
    </tr>
    {% endfor %}
    </tbody>
  </table>
</div>
</div>
{% endblock %}
